<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet/less" href="style.less" />
		<script src="knockout-2.3.0.js"></script>
		<script src="knockout.mapping-latest.js"></script>
		<script src="sugar-1.3.9.min.js"></script>
		<script src="zepto.min.js"></script>
		<script	src="less-1.4.1.min.js"></script>
		<title>mechanize</title>

		<script type="text/html" id="DeviceTemplateInventory">
			<div class="inventory resource-container" data-bind="foreach: items">
				<!-- ko if: resource -->
					<div class="resource" data-bind="
						css: resource().type + (active() ? ' active' : ''), 
						title: resource().type,
						click: $parent.select ">
					</div>
				<!-- /ko -->
				<!-- ko ifnot: resource -->
					<div class="resource none"></div>
				<!-- /ko -->
			</div>
			<div>
				<strong>Selected:</strong> 
				<!-- ko if: activeItem -->
					<div>
						Send <span data-bind="text: activeItem().resource().type"></span> to:
					</div>
					<div data-bind="foreach: outputs">
						<button data-bind="
							text: $data, 
							click: $parent.sendActiveTo"></li>
					</div>					
				<!-- /ko -->
				<!-- ko ifnot: activeItem -->
					None
				<!-- /ko -->
			</div>
		</script>

		<script type="text/html" id="DeviceTemplateRockCollector">
			<div class="progress" data-bind="if: tracker">
				<div class="value" data-bind="style: { marginRight: tracker.progress.marginRight }">
					Collecting ...
				</div>
			</div>
			<button data-bind="click: start">start</button>
			<button data-bind="click: stop">stop</button>
		</script>

		<script type="text/html" id="DeviceTemplateTrashEjector">
			<strong>Contents:</strong>
			<!-- ko if: contents -->
				<span data-bind="text: contents().type"></span>
				<div class="progress" data-bind="if: tracker">
					<div class="value" data-bind="style: { marginRight: tracker().progress.marginRight }">
						Airlock cycling ...
					</div>
				</div>
			<!-- /ko -->
			<!-- ko ifnot: contents -->
				<span>Empty</span>
			<!-- /ko -->
		</script>

		<script type="text/html" id="DeviceTemplateWastes">
			<div class="progress">
				<div class="value" data-bind="style: { marginRight: regenerator().progress.marginRight }">
					Sector Warp ...
					<div class="go">go</div>
				</div>
			</div>

			<div id="wastes" class="resource-container" data-bind="foreach: junk">
				<!-- ko if: resource -->
					<div class="resource" data-bind="css: resource().type, title: resource().type">
						<div class="collect-progress"></div>
						<div class="collector" data-bind="click: $parent.collect"></div>
					</div>
				<!-- /ko -->
				<!-- ko ifnot: resource -->
					<div class="resource none"></div>
				<!-- /ko -->
			</div>
		</script>
	</head>
	<body>
		<div id="loadingMessage">
			loading ...
		</div>
		<div id="systemError">
			<span class="message">Error during load.</span>
			<br><a href="javascript:location.reload();">Reload</a>
			<br><a href="javascript:window.localStorage.removeItem('mechanize');location.reload();">Reset data</a>
		</div>
		<div id="gameSurface" style="visibility: hidden;">
			<div id="game-controls">
				<button id="saveButton">save</button>
				<button id="resetButton">reset</button>
				<button id="notificationsButton">notifications</button>
				<ul id="notificationsLog" data-bind="foreach: notifications.log">
					<li data-bind="text: $data"></li>
				</ul>
			</div>

			<div id="notifications">
			</div>

			<div id="playerData" class="panel" data-bind="with: player">
				<h2>Player</h2>
				<strong>Name:</strong> <span data-bind="text: name"></span>
			</div>

			<div id="devices" class="panel" data-bind="with: devices">
				<h2>Devices</h2>
				<ul data-bind="foreach: attached">
					<li class="device" data-bind="attr: {'data-device': name}, css: type">
						<div class="title" data-bind="css: uistate">
							<button class="detacher" data-bind="click: detach">
								&hArr;
							</button>
							<h3 data-bind="text: name, click: toggleCollapse"></h3>
						</div>
						<!-- <span data-bind="text: type"></span> -->
						<div class="controls" data-bind="
							template: {
								if: uistate() != 'collapsed', 
								name: 'DeviceTemplate' + type, 
								data: $data}">
						</div>
					</li>
				</ul>
			</div>

			<!-- ko foreach: devices.detached -->
			<div class="panel device" data-bind="attr: {'data-device': name}, css: type">
				<button class="detacher" data-bind="click: expand">
					&hArr;
				</button>
				<h2 data-bind="text: name"></h2>
				<h3 data-bind="text: type"></h3>
				<div class="controls" data-bind="
					template: {
						name: 'DeviceTemplate' + type, 
						data: $data}">
				</div>
			</div>
			<!-- /ko -->
			<div 
		</div>

		<script src="mechanize.js"></script>
	</body>	
</html>