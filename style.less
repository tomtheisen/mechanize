@import "prefixer.less";

@font-face {
  font-family: 'Aldrich';
  font-style: normal;
  font-weight: 400;
  src: local('Aldrich'), url(aldrich.woff) format('woff');
}

@background: #272D40;
@panel: #364659;
@accent: #55736D;
@highlight: #D0D3B8;
@green: #9DBF8E;  // ?
@space: #0D1216;

.hover-highlight-background(@color) {
	background-color: @color;
	&:hover {
		background-color: lighten(@color, 10%);
	}
}

html {
	height: 100%;
	margin: 0;
	font-size: 10pt;
}

:last-child {
	margin-bottom: 0 !important;
}

body {
	font-family: 'Aldrich', sans-serif;
	background-color: @background;
	color: @highlight;
	margin: 0;
	padding-top: 2rem;
}

header {
	h1 {
		color: @background;
	}

	button, label {
		.hover-highlight-background(@panel);

		&.warning {
			.hover-highlight-background(#662937);
		}
	}

	background-color: black;
	color: @highlight;
	.box-sizing(border-box);
	height: 1.6rem;
	margin: 0;
	padding: 0 2rem;
	overflow: hidden;
	position: fixed;
	z-index: 99;
	width: 100%;
	top: 0;
	left: 0;

	&:hover {
		height: auto;
		padding-bottom: 2rem;
	}
}

h1, h2, h3, h4 {
	margin: 0 0 1rem 0;
}

h1 {
	font-size: 2rem;
}

h3 {
	font-size: 1.1rem;
}

p {
	padding: 0.3rem;
}

ul {
	padding: 0;
	list-style-type: none;
}

button, label {
	display: inline-block;
	.hover-highlight-background(@accent);
	color: @highlight;
	border-width: 0; 
	.border-radius(1rem);
	height: 1.6rem;
	padding: 0 1.2rem;
	font-family: 'Aldrich', sans-serif;
	font-size: 1rem;
	cursor: pointer;
	margin: 0.3rem;
}

a {
	color: @highlight;
}

#systemMessage {
	padding: 3rem;
}

#gameSurface {
	width: 100%;
	white-space: nowrap;

	&>* {
		white-space: normal;
	}
}

#notifications {
	position: fixed;
	margin: 1.2rem;
	right: 0;
	bottom: 0;
	
	.notification {
		margin: 1.2rem;
		.border-radius(1.2rem);
		.box-sizing(border-box);
		padding: 0.6rem 1.2rem;
		background-color: @panel;
		max-width: 30rem;
		max-height: 30rem;
		white-space: nowrap;
		overflow: hidden;
		cursor: pointer;
		text-align: right;
	}
}

.progress {
	.box-sizing(border-box);
	height: 2.4rem;
	.border-radius(0 1.2rem 1.2rem 0);
	padding: 0.6rem 0.6rem 0.6rem 0;
	overflow: hidden;
	margin: 1rem 0;
	background-color: @accent;

	.value {
		.border-radius(0 0.6rem 0.6rem 0);
		height: 1.2rem;
		text-indent: 1em;
		font-size: 0.8rem;
		background-color: @highlight;
		color: @panel;
		overflow: hidden;
		position: relative;
		white-space: nowrap;
	}
}

.panel {
	.border-radius(1.2rem);
	background-color: @panel;
	color: @highlight;
	padding: 0.9rem;
	margin: 1.2rem;
	width: 20rem;
	display: inline-block;
	vertical-align: top;
}

.resource-container {
	overflow: auto;
	margin-top: 1.2rem;
	padding: 0.6rem;
	background-color: @space;
	border: solid @accent 0.6rem;
	.border-radius(0.6rem);
	margin: 0.6rem 0;
	display: inline-block;
}

.wrap-every(@n) {
	/* http://stackoverflow.com/a/18122516/44743 */
	@t: ~":nth-child(@{n}n+1)";
  	&@{t} {
        clear: left;
    }
}

.resource {
	@resource-size: 24px;

	float: left;
	width: @resource-size;
	height: @resource-size;
	margin: 1px;
	.box-sizing(border-box);
	position: relative;

	.wrap-every(8);
	
	.collect-delay(@delay) {
		&:hover {
			.collect-progress 	{ .transition-duration(@delay); }
			.collector 			{ .transition-delay(@delay); }
		}
	}

	.resource(@tile-index, @collection-delay) {
		background-position-x: (-@resource-size * @tile-index);
		.collect-delay(@collection-delay);
	}

	background-image: url(resource-tiles.png);
	background-size: auto @resource-size;
	background-color: red;  /* for debugging, should never see */
	&.rock { .resource(1, 2s); }
	&.iron { .resource(2, 5s); }
	&.none { background-color: #000; }


	.collect-progress {
		width: 0%;
		height: 10%;
		position: absolute;
		background-color: @green;
	}

	.collector {
		width: 100%;
		height: 100%;
		position: absolute;
		visibility: hidden;

		background-color: white;
		.opacity(0.2);
	}

	&:hover {
		.collect-progress {
			.transition-timing-function(linear);
			width: 100%;
		}

		.collector {
			visibility: visible;
			cursor: pointer;
		}
	}
}

.active {
	border: solid #ccc 1px;
	.animation-name(active-pulse);
	.animation-duration(0.5s);
	.animation-iteration-count(infinite);
	.animation-direction(alternate);
}

// come on LESS, get your shit together
@-o-keyframes active-pulse { from {border-color: #333;} to {border-color: #ddd;}}
@-moz-keyframes active-pulse { from {border-color: #333;} to {border-color: #ddd;}}
@-webkit-keyframes active-pulse { from {border-color: #333;} to {border-color: #ddd;}}
@keyframes active-pulse { from {border-color: #333;} to {border-color: #ddd;}}

.inventory {
	.resource { cursor: pointer; }
	.resource.none { cursor: default; }
}

.panel .device {
	margin-bottom: 1.2rem;

	.deviceHeader {
		.detacher {
			height: 100%;
			padding: 0 0.3rem;
			margin: 0;
			cursor: pointer;
			width: 2.4rem;
			height: 1.6rem;
			line-height: 1.6rem;
			position: relative;
			left: 2.4rem;
		}

		height: 1.6rem;
		line-height: 1.6rem;
		padding: 0;
		margin-right: 2.4rem;
		position: relative;
		cursor: pointer;
		white-space: nowrap;
	}

	.controls {
		margin-left: 1.2rem;

		& > :first-child {
			margin-top: 0.6rem;
		}
	}
}

.collapser.collapsed::before {content: "\25b6"; }
.collapser.expanded::before {content: "\25bc"; }
.collapser.collapsed + * {
	display: none;
}

.device {
	.animate-color (@color)  {
		background-color: (@color);
		.transition-duration(0s);
	}

	.detacher {
		display: block;
		float: right;
	}

	.deviceHeader {
		.border-radius(0.6rem);
		background-color: @panel;
		.transition(background-color 500ms ease-out);
	}

	&.bumped .deviceHeader { .animate-color(@panel + #222); }
	&.error  .deviceHeader { .animate-color(@panel + #400); }	
}