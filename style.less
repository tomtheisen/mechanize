@import "prefixer.less";

@font-face {
  font-family: 'Aldrich';
  font-style: normal;
  font-weight: 400;
  src: local('Aldrich'), url(aldrich.woff) format('woff');
}

@background: #272D40;
@panel: #364659;
@accent: #55736D;
@highlight: #D0D3B8;
@green: #9DBF8E;  // ?
@space: #0D1216;

html {
	height: 100%;
	margin: 0;
	font-size: 10pt;
}

body {
	font-family: 'Aldrich', sans-serif;
	background-color: @background;
	color: @highlight;
	height: 100%;
	margin: 0;
}

h1, h2, h3, h4 {
	margin: 0 0 1rem 0;

	&:last-child {
		margin-bottom: 0;
	}
}

ul {
	padding: 0;
	list-style-type: none;
}

button {
	background-color: @accent;
	&:hover { background-color: (@accent + #222); };
	color: @highlight;
	border-width: 0; 
	.border-radius(1rem);
	height: 1.6rem;
	padding: 0 1.2rem;
	font-family: 'Aldrich', sans-serif;
	font-size: 1rem;
	cursor: pointer;
	margin: 0.3rem;
}

a {
	color: @highlight;
}

#loadingMessage {
	padding: 3rem;
}

#systemError {
	padding: 3rem;
	display: none;
}

#gameSurface {
	width: 100%;
	height: 100%;
}

#playerData #gameControls {
	#notificationsLog {
		display: none;
	}
}

#notifications {
	position: absolute;
	margin: 1.2rem;
	right: 0;
	bottom: 0;
	
	.notification {
		margin: 1.2rem;
		.border-radius(1.2rem);
		.box-sizing(border-box);
		padding: 0.6rem;
		background-color: @panel;
		max-width: 30rem;
		max-height: 30rem;
		white-space: nowrap;
		overflow: hidden;
		cursor: pointer;
		text-align: right;
	}
}

.progress {
	box-sizing: border-box;
	height: 2.4rem;
	.border-radius(0 1.2rem 1.2rem 0);
	padding: 0.6rem 0.6rem 0.6rem 0;
	overflow: hidden;
	margin: 1rem 0;
	background-color: @accent;

	.value {
		.border-radius(0 0.6rem 0.6rem 0);
		height: 1.2rem;
		text-indent: 1em;
		font-size: 0.8rem;
		background-color: @highlight;
		color: @panel;
		overflow: hidden;
		position: relative;
		white-space: nowrap;
	}
}

.panel {
	.border-radius(1.2rem);
	background-color: @panel;
	padding: 1.2rem;
	margin: 1.2rem;
	display: inline-block;
	vertical-align: top;

	/* make last thing in panel not have bottom margin to keep padding tight */
	&>:last-child {
		margin-bottom: 0;
	}
}

.resource-container {
	overflow: auto;
	margin-top: 1.2rem;
	padding: 0.6rem;
	background-color: @space;
	border: solid @accent 0.6rem;
	.border-radius(0.6rem);
	margin: 0.6rem 0;
}

.wrap-every(@n) {
  	&:nth-child(@{n}n+1) {
        clear: left;
    }
}

.resource {
	float: left;
	width: 32px;
	height: 32px;
	margin: 1px;
	.box-sizing(border-box);
	position: relative;

	.wrap-every(8);
	
	background-color: red;  /* for debugging, should never see */
	&.none { background-color: black; }

	.collect-delay(@delay) {
		&:hover {
			.collect-progress 	{ .transition-duration(@delay); }
			.collector 			{ .transition-delay(@delay); }
		}
	}

	.resource(@tile-index; @collection-delay) {
		background-image: url(img/resource-tiles.png);
		background-position-x: (-32px * @tile-index);
		.collect-delay(@collection-delay);
	}

	&.rock { .resource(0; 2s); }
	&.iron { .resource(1; 5s); }

	.collect-progress {
		width: 0%;
		height: 10%;
		position: absolute;
		background-color: @green;
	}

	.collector {
		width: 100%;
		height: 100%;
		position: absolute;
		visibility: hidden;

		background-color: white;
		.opacity(0.2);
	}

	&:hover {
		.collect-progress {
			.transition-timing-function(linear);
			width: 100%;
		}

		.collector {
			visibility: visible;
			cursor: pointer;
		}
	}
}

.active {
	border: solid #ccc 1px;
	.animation-name(active-pulse);
	.animation-duration(0.5s);
	.animation-iteration-count(infinite);
	.animation-direction(alternate);
}

// come on LESS, get your shit together
@-o-keyframes active-pulse { from {border-color: #333;} to {border-color: #ddd;}}
@-moz-keyframes active-pulse { from {border-color: #333;} to {border-color: #ddd;}}
@-webkit-keyframes active-pulse { from {border-color: #333;} to {border-color: #ddd;}}
@keyframes active-pulse { from {border-color: #333;} to {border-color: #ddd;}}

.inventory {
	.resource { cursor: pointer; }
	.resource.none { cursor: default; }
}

#devices.panel .device {
	.title {
		.border-radius(0.6rem);
		overflow: hidden;
		margin-top: 1.2rem;

		.detacher {
			padding: 0.3rem;
			display: block;
			float: right;
			cursor: pointer;
			margin: 0;
			.border-radius(0px);
			height: 2rem;	/*hack*/
		}

		h3 {
			position: relative;
			cursor: pointer;
			font-size: 1rem;
			padding: 0.3rem;
			margin-right: 2.4rem;
			white-space: nowrap;
	
		}
		&.collapsed h3::before {content: "\25b6"; }
		&.expanded h3::before {content: "\25bc"; } 
	
		.transition(background-color 500ms ease-out);
	}
	
	.animate-color (@color)  {
		background-color: (@color);
		.transition-duration(0s);
	}

	&.bumped .title { .animate-color(@panel + #222); }
	&.error  .title { .animate-color(@panel + #400); }

	.controls {
		margin-left: 1.2rem;

		& > :first-child {
			margin-top: 0.6rem;
		}
	}
}

.panel.device {
	.detacher {
		display: block;
		float: right;
	}

	.animate-color (@color)  {
		background-color: (@color);
		.transition-duration(0s);
	}

	h2 { 
		.transition(background-color 500ms ease-out);
		.border-radius(0.6rem);
	}
	&.bumped h2 { .animate-color(@panel + #222); }
	&.error  h2 { .animate-color(@panel + #400); }
}